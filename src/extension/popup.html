<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ProxyForge Control Panel</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>ProxyForge</h1>
      <div class="status-indicator">
        <span class="status-dot" id="statusDot"></span>
        <span id="statusText">Inactive</span>
      </div>
    </header>

    <main>
      <!-- Main Controls -->
      <section class="control-panel">
        <button id="toggleBtn" class="btn btn-primary">Enable Proxy</button>
        <button id="rotateBtn" class="btn btn-secondary">Rotate Now</button>
      </section>

      <!-- Auto-Rotation Section -->
      <section class="auto-rotate-section">
        <div class="auto-rotate-header">
          <h2>Auto-Rotation Mode</h2>
          <label class="switch">
            <input type="checkbox" id="autoRotateToggle">
            <span class="slider"></span>
          </label>
        </div>
        <p class="auto-rotate-info">Automatically rotate proxy when browsing different websites</p>
        
        <div id="autoRotateConfig" class="auto-rotate-config hidden">
          <div class="current-domain">
            <span>Current Domain:</span>
            <span id="currentDomain">-</span>
            <button id="addCurrentDomainBtn" class="btn-small">Add to Whitelist</button>
          </div>
          
          <div class="whitelist-section">
            <h3>Whitelist (Leave empty for all sites)</h3>
            <div id="whitelistDomains" class="domain-list"></div>
            <div class="input-group">
              <input type="text" id="newWhitelistDomain" placeholder="example.com">
              <button id="addWhitelistBtn" class="btn-small">Add</button>
            </div>
          </div>
        </div>
      </section>

      <!-- Local Proxy Status -->
      <section class="local-proxy-status">
        <div class="status-header">
          <h2>Local AWS Proxy</h2>
          <div class="connection-status">
            <span class="status-indicator" id="localProxyIndicator"></span>
            <span id="localProxyStatus">Checking...</span>
          </div>
        </div>
        <div id="awsGatewayInfo" class="aws-info hidden">
          <p><strong>Active Gateways:</strong> <span id="activeGatewayCount">0</span></p>
          <p><strong>Current Region:</strong> <span id="currentRegion">-</span></p>
          <button id="createGatewayBtn" class="btn btn-small">Create Gateway</button>
          <button id="viewGatewaysBtn" class="btn btn-small">View Gateways</button>
        </div>
      </section>

      <!-- Current Proxy Info -->
      <section class="proxy-info">
        <h2>Current Proxy</h2>
        <div id="currentProxyInfo" class="info-box">
          <p class="no-proxy">No proxy active</p>
        </div>
      </section>

      <!-- Statistics -->
      <section class="statistics">
        <h2>Statistics</h2>
        <div class="stats-grid">
          <div class="stat-item">
            <span class="stat-label">Total Requests</span>
            <span class="stat-value" id="totalRequests">0</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Rotations</span>
            <span class="stat-value" id="rotations">0</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Uptime</span>
            <span class="stat-value" id="uptime">0s</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Avg Rotation</span>
            <span class="stat-value" id="avgRotation">0s</span>
          </div>
        </div>
      </section>

      <!-- Settings -->
      <section class="settings">
        <h2>Settings</h2>
        
        <div class="setting-group">
          <label for="rotationMode">Rotation Mode</label>
          <select id="rotationMode">
            <option value="sequential">Sequential</option>
            <option value="random">Random</option>
          </select>
        </div>

        <div class="setting-group">
          <label for="rotationFrequency">Rotate Every N Requests</label>
          <input type="number" id="rotationFrequency" min="1" max="100" value="1">
        </div>

        <div class="setting-group">
          <button id="configureProxiesBtn" class="btn btn-secondary">Configure Proxies</button>
          <button id="configureGatewaysBtn" class="btn btn-secondary">API Gateways</button>
        </div>
      </section>

      <!-- Proxy Configuration Modal -->
      <div id="proxyModal" class="modal">
        <div class="modal-content">
          <h2>Configure Proxy Endpoints</h2>
          <div id="proxyList" class="proxy-list"></div>
          <button id="addProxyBtn" class="btn btn-secondary">Add Proxy</button>
          <div class="modal-actions">
            <button id="saveProxiesBtn" class="btn btn-primary">Save</button>
            <button id="cancelProxiesBtn" class="btn btn-secondary">Cancel</button>
          </div>
        </div>
      </div>

      <!-- API Gateway Configuration Modal -->
      <div id="gatewayModal" class="modal">
        <div class="modal-content modal-large">
          <h2>API Gateway Manager</h2>
          <p class="modal-info">Create dynamic API gateways for any URL on the fly</p>
          
          <!-- Create New Gateway Section -->
          <div class="gateway-section">
            <h3>Create New Gateway</h3>
            <div class="form-group">
              <label for="newGatewayUrl">Target URL</label>
              <input type="text" id="newGatewayUrl" placeholder="https://api.example.com" class="input-full">
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="gatewayType">API Type</label>
                <select id="gatewayType">
                  <option value="rest">REST API</option>
                  <option value="graphql">GraphQL</option>
                  <option value="websocket">WebSocket</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="gatewayAuth">Authentication</label>
                <select id="gatewayAuth">
                  <option value="none">None</option>
                  <option value="bearer">Bearer Token</option>
                  <option value="apiKey">API Key</option>
                  <option value="basic">Basic Auth</option>
                </select>
              </div>
            </div>
            
            <div id="authConfig" class="auth-config hidden">
              <input type="text" id="authValue" placeholder="Enter authentication value" class="input-full">
            </div>
            
            <div class="form-row">
              <button id="createGatewayBtn" class="btn btn-primary">Create Gateway</button>
              <button id="autoDetectBtn" class="btn btn-secondary">Auto-Detect Endpoints</button>
            </div>
          </div>
          
          <!-- Active Gateways Section -->
          <div class="gateway-section">
            <h3>Active Gateways</h3>
            <div id="activeGatewaysList" class="gateway-list">
              <p class="no-gateways">No active gateways</p>
            </div>
          </div>
          
          <!-- Quick Actions -->
          <div class="gateway-section">
            <h3>Quick Actions</h3>
            <div class="quick-actions">
              <button id="testGatewayBtn" class="btn btn-secondary">Test Selected Gateway</button>
              <button id="exportConfigBtn" class="btn btn-secondary">Export Configuration</button>
              <button id="importConfigBtn" class="btn btn-secondary">Import Configuration</button>
            </div>
          </div>
          
          <div class="modal-actions">
            <button id="closeGatewayBtn" class="btn btn-primary">Close</button>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <p>Dynamic IP Rotation System</p>
    </footer>
  </div>

  <script src="popup.js"></script>
</body>
</html>